{% load static %}


<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
            <div class="modal-header">
                <h5 class="modal-title" id="cartModalLabel">
                    <i class="fa-solid fa-basket-shopping"></i>&nbsp;&nbsp;–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="position: absolute; right: 1rem; top: 1rem;"></button>
            </div>

            <!-- –¢–µ–ª–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–æ—Ä–∑–∏–Ω—ã-->
            {% for cart in carts %}
                <div class="modal-body">
                    <div id="cartItems">
                        <!-- –ü–µ—Ä–µ—á–µ–Ω—å —Ç–æ–≤–∞—Ä–æ–≤ -->
                        <div class="cart-item d-flex align-items-center">
                            <img src="{{ cart.product.image.url }}" alt="–¢–æ–≤–∞—Ä" class="cart-item-img me-3">
                            <div class="flex-grow-1">
                                <h5 class="mb-1">{{cart.product.name}}</h5>
                            <p class="mb-1">
                                –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É: <span class="item-price" 
                                                       data-price="{{ cart.product.sell_price }}">
                                                       {{ cart.product.sell_price | floatformat:2 }}
                                                </span> ‚ÇΩ
                            </p>
                            <p class="mb-1">
                                –û–±—â–∞—è —Ü–µ–Ω–∞: <span class="item-total-price">{{ cart.products_price | floatformat:2 }}</span> ‚ÇΩ
                            </p>                                
                            <div class="small text-muted">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{cart.product.category.title}}</div>
                            </div>
                            <div class="d-flex align-items-center">
                                <button class="btn btn-outline-secondary btn-sm me-2 znak-products" onclick="updateQuantity(this, -1)">
                                    <i class="fa-solid fa-minus"></i>
                                </button>
                                <input type="text" value="{{cart.quantity}}" min="1" 
                                    class="form-control form-control-sm text-center" 
                                    style="width: 60px;" 
                                    readonly>
                                <button class="btn btn-outline-secondary btn-sm ms-2 znak-products" onclick="updateQuantity(this, 1)">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                            </div>
                            {# –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã #}
                            <button class="btn btn-danger btn-sm ms-3 cart-delete" onclick="removeItem(this)">
                                <a href="{% url "cart:cart_remove" 1 %}" class="col_cart_del">
                                    <i class="fa-solid fa-trash"></i>
                                </a> 
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
            <!-- –ù–∏–∂–Ω—è—è —á–∞—Å—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
            <div class="modal-footer flex-column align-items-start">
                <!-- –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è -->
                <div class="w-100 mb-3">
                    <p class="mb-1">–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: <span id="totalQuantity">{{carts.total_quantity}}</span></p>
                    <p class="cart-total">–û–±—â–∞—è —Ü–µ–Ω–∞: <span id="totalPrice">{{carts.total_price}}</span> ‚ÇΩ</p>
                </div>
                
                {% if user.is_authenticated %}
                <!-- –†–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã -->
                <div class="w-100 mb-3">
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</p>
                    <form class="d-flex flex-column">
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="paymentMethod" id="paymentCash" value="cash">
                            <label class="form-check-label" for="paymentCash">
                                üíµ –ù–∞–ª–∏—á–Ω—ã–º–∏/–ö–∞—Ä—Ç–æ–π –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="paymentMethod" id="paymentCard" value="card">
                            <label class="form-check-label" for="paymentCard">
                                üí≥ –û–ø–ª–∞—Ç–∏—Ç—å –∫–∞—Ä—Ç–æ–π
                            </label>
                        </div>
                    </form>
                </div>
                {% else %}
                <!-- –ë–ª–æ–∫ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
                <div id="authNotice" class="w-100 text-center mb-3">
                    <p>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ <strong>–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º</strong> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.</p>
                    <a href="{% url "user:login" %}" class="btn btn-link">
                        <i class="fa-regular fa-user"></i> –í–æ–π—Ç–∏
                    </a>
                    <a href="{% url "user:register" %}" class="btn btn-link">
                        <i class="fa-solid fa-registered"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
                    </a>
                </div>
                {% endif %}
                <hr class="hr" />
                <!-- –ö–Ω–æ–ø–∫–∏ "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑" –∏ "–ó–∞–∫—Ä—ã—Ç—å" -->
                <div class="d-flex justify-content-between w-100">
                    {% if user.is_authenticated %}
                        <hr>
                        <button type="button" class="btn btn-success" id="checkoutButton" onclick="placeOrder()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
                    {% endif %}
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>
    </div>
</div>